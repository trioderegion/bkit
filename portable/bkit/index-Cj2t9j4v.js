class DevSheet5e{static{game.settings.register('bkit','taboo',{name:'Flatten Item Sheets',hint:"It's...tab-boo :D",scope:'user',type:Boolean,config:!0,default:!1}),Hooks.on("renderActivitySheet",((app,frame)=>{frame.classList.toggle('taboo',game.settings.get('bkit','taboo'))})),Hooks.on("renderItemSheet5e",((app,frame)=>{frame.classList.toggle('taboo',game.settings.get('bkit','taboo')),app.constructor.itemHasActivities(app.document)&&app.changeTab('activities','primary')}))}}class FlagData extends foundry.abstract.DataModel{static get scope(){return'dnd5e'}static get inner(){return''}static get flagPath(){return`flags.${this.scope}${this.inner}`}read(doc){return foundry.utils.getProperty(doc,this.constructor.flagPath)}updateFrom(doc){return this.updateSource(this.read(doc))}}class ToCEntryData extends FlagData{static defineSchema(){const fields=foundry.data.fields;return{title:new fields.StringField({required:!1,label:'Custom Title',nullable:!0}),type:new fields.StringField({required:!1,label:'Type',choices:{chapter:'Chapter',appendix:'Appendix',special:'Special',header:'Header'}}),showPages:new fields.BooleanField({required:!1,label:'Show Pages',initial:void 0}),position:new fields.NumberField({required:!1,label:'Position',positive:!0,integer:!0,initial:void 0}),append:new fields.NumberField({required:!1,label:'Append Position*',positive:!0,integer:!0,initial:void 0}),order:new fields.NumberField({required:!1,label:'Sort Order*',positive:!0,integer:!0,initial:void 0})}}static cleanData(source={},options={}){const data=super.cleanData(source,options);return data.title=data.title?data.title:null,data}}class ToCPageData extends FlagData{static defineSchema(){return{tocHidden:new foundry.data.fields.BooleanField({required:!1,initial:void 0,label:'Hide Page'})}}}class NavData extends FlagData{static defineSchema(){const fields=foundry.data.fields;return{previous:new fields.DocumentIdField({required:!1,readonly:!1,initial:void 0,label:'Previous (ID)'}),next:new fields.DocumentIdField({required:!1,readonly:!1,initial:void 0,label:'Next (ID)'}),up:new fields.DocumentIdField({required:!1,readonly:!1,initial:void 0,label:'Up (ID)'})}}static get inner(){return'.navigation'}}class Flagger extends foundry.applications.api.ApplicationV2{static DEFAULT_OPTIONS={tag:'form',form:{submitOnChange:!1,closeOnSubmit:!0,handler:this.prototype.submitHandler},window:{contentClasses:['standard-form']}};static APP_CONTROLS={icon:'fa-table-columns',label:'Configure Flags',field:''};static hook(){Hooks.on('getHeaderControlsApplicationV2',((app,controls)=>{controls.push({icon:`fa-solid ${this.APP_CONTROLS.icon}`,label:this.APP_CONTROLS.label,onClick:()=>new this({document:app.options.document}).render({force:!0}),visible:()=>this.compatible(app.options.document)})}))}static compatible(doc){return!!doc?.id}flagData=null;get document(){return this.options.document}constructor(flagModel,options){super(options),this.flagData=new flagModel,this.flagData.updateFrom(this.document)}_initializeApplicationOptions(options){return(options=super._initializeApplicationOptions(options)).window.title=`Flagging ${options.document.documentName}: ${options.document.name}`,options}async _prepareContext(options){const context=await super._prepareContext(options);return this.flagData.updateFrom(this.document),context.entries=Object.entries(this.flagData.schema.fields).map((([key,field])=>({field,value:this.flagData[key]}))),context}_ingestSubmit(update){return update}async submitHandler(evt,form,data){const updateData=this._ingestSubmit(data.object);this.flagData.updateSource(updateData),await this.document.update({[this.flagData.constructor.flagPath]:this.flagData.toObject()})}async _renderHTML(context,options){const buttons=await foundry.applications.handlebars.renderTemplate("templates/generic/form-footer.hbs",{buttons:[{type:'submit',label:'Submit'}]}),fieldset=document.createElement('fieldset'),legend=document.createElement('legend');return legend.innerText=this.constructor.APP_CONTROLS.field,fieldset.appendChild(legend),context.entries.forEach((data=>fieldset.appendChild(data.field.toFormGroup({},{value:data.value})))),[fieldset,buttons]}_replaceHTML(elements,content,options){const footer=elements.pop();content.replaceChildren(...elements),content.insertAdjacentHTML('beforeend',footer)}}class ToCFlagger extends Flagger{static APP_CONTROLS={icon:'fa-table-columns',label:'ToC Flags',field:'Table of Contents'};static{this.hook()}static compatible(doc){return super.compatible(doc)&&(doc?.documentName.includes('JournalEntry')??!1)}constructor(options){super('JournalEntryPage'===options.document?.documentName?ToCPageData:ToCEntryData,options)}}class NavFlagger extends Flagger{static APP_CONTROLS={icon:'fa-compass',label:'Nav Flags',field:'Navigation'};static compatible(doc){return super.compatible(doc)&&'JournalEntry'==doc.documentName}static{this.hook()}constructor(options){super(NavData,options)}}
//# sourceMappingURL=index-Cj2t9j4v.js.map
